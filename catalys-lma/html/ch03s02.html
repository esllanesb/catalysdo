
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title xmlns:d="http://docbook.org/ns/docbook">Catalys LMA User Guide &#151; 3.2.&nbsp;Configuration File</title><link rel="stylesheet" type="text/css" href="../resources/docbook.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Catalys LMA User Guide"><link rel="up" href="ch03.html" title="Chapter&nbsp;3.&nbsp;Configuration"><link rel="prev" href="ch03.html" title="Chapter&nbsp;3.&nbsp;Configuration"><link rel="next" href="ch03s03.html" title="3.3.&nbsp;Logging"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns:d="http://docbook.org/ns/docbook" class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="ch03.html">Prev</a>&nbsp;</td><th width="60%" align="center"><div id="navheader_chapter_title">Chapter&nbsp;3.&nbsp;Configuration</div><div><a accesskey="h" href="index.html">Home</a></div></th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch03s03.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="Local_Management_Agent_Configuration-config-file"></a>3.2.&nbsp;Configuration File</h2></div></div></div><p>The LMA's configuration file is <span class="emphasis"><em>conf/lma.conf</em></span>.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="Local_Management_Agent_Configuration-Specifying_custom_pgrep_and_pkill"></a>3.2.1.&nbsp;Specifying custom pgrep
  and pkill commands</h3></div></div></div><p>The implementation of attribute
  <span class="emphasis"><em>applicationProcessRunning</em></span> and
  operation <span class="emphasis"><em>killApplicationProcess()</em></span> in
  application delegate MBeans requires that the LMA be able to
  issue the following operating-system commands:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">A <span class="emphasis"><em>pgrep</em></span> command to
    search for a process with the given PID</li><li class="listitem">A <span class="emphasis"><em>pkill</em></span> command to kill the
    process with the given PID</li></ul></div><p>The LMA provides default pgrep and pkill command on both Unix and
  Windows platforms, and you normally should not need to override
  these commands. Below are the default commands, with %p
  representing the PID of the process to look for or kill:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">On Unix:

    <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">pgrep command: <code class="code">sh
        -c [ -d /proc/%p ]</code></li><li class="listitem">pkill command: <code class="code">sh
        -c kill -9 %p</code></li></ul></div></li><li class="listitem">On Windows:

    <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">pgrep command: <code class="code">cmd /c tasklist /NF /FI "PID eq
        %p"2&gt;NUL|find "%p"&gt;NUL</code></li><li class="listitem">pkill command: <code class="code">cmd /c taskkill /F /PID
        %p</code></li></ul></div></li></ul></div><p>If you wish to override these default commands, it is possible to
  do so by specifying attributes <code class="code">pgrep-command</code> and/or
  <code class="code">pkill-command</code> in the
  configuration:</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE lma-configuration
  SYSTEM 'http://www.camerontecgroup.com/dtd/management/lma-configuration.dtd'&gt;
  &lt;lma-configuration pgrep-command="some command with a %p in it"
                     pkill-command="some other command with a %p in it"/&gt;</pre><p>Note:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">It is possible to specify only one custom command without
    the other</li><li class="listitem">Custom commands must contain at least one occurrence of the
    %p placeholder, which will be replaced at runtime by the actual
    PID of the process to look for/kill.</li><li class="listitem">On Unix, if a custom command does not start with
    <code class="code">sh -c</code>, then
    the <code class="code">sh -c</code>
    prefix will be prepended to it.</li><li class="listitem">On Windows, if a custom command does not start with
    <code class="code">cmd /c</code>, then the
    <code class="code">cmd /c</code> prefix will
    be prepended to it.</li><li class="listitem">The specified custom pgrep command is expected to follow
    some guidelines:

    <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">The command should not generate any error output</li><li class="listitem">The command should have an exit value of 0 (zero) if
        the process with the given PID is found.</li><li class="listitem">The command should have an exit value different from 0
        (zero) if the process with the given PID is not found.</li></ul></div></li><li class="listitem">The specified custom pkill command is expected to follow
    some guidelines:

    <div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem">The command should not generate any error output</li><li class="listitem">The command should always have an exit value of 0 (zero).</li></ul></div></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="Local_Management_Agent_Configuration-Changing_the_default_ports"></a>3.2.2.&nbsp;Changing default ports</h3></div></div></div><p>
      By default, the local communication between the LMA and managed FIX servers is done on port 10001. To change the
      default port, a new JMX service URL will need to be configured in the <code class="code">internal-jmx-server-url</code>
      attribute of the <code class="code">lma-configuration</code> element. The format is as follows:
    </p><pre class="programlisting">&lt;lma-configuration
    internal-jmx-service-url="service:jmx:jmxmp://localhost:PORT"/&gt;</pre><p>
      By default, the communication between the LMA and the MIS, as well as the LMA and other Nodes (if running in an
      HA cluster), is done on port 10002. To change the default port, a new JMX service URL will need to be configured
      in the <code class="code">external-jmx-server-url</code> attribute of the <code class="code">lma-configuration</code> element. The format
      is as follows:
    </p><pre class="programlisting">&lt;lma-configuration
    external-jmx-service-url="service:jmx:jmxmp://localhost:PORT"/&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="Local_Management_Agent_Configuration-Specifying_security_settings"></a>3.2.3.&nbsp;Specifying security settings</h3></div></div></div><p>You can instruct the LMA to use some encryption in its
    communication with the MIS. Encryption can be configured in the
    <span class="emphasis"><em>security</em></span> section of
    the LMA's configuration file. By default, no encryption is used
    in the connection with the MA.</p><p><span class="bold"><strong>If some security is configured
    here, then the MIS should also be configured
    accordingly.</strong></span></p><p>The example below demonstrates how to configure TLS security:</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE lma-configuration
   SYSTEM 'http://www.camerontecgroup.com/dtd/management/lma-configuration.dtd'&gt;
&lt;lma-configuration&gt;
  &lt;security&gt;
    &lt;tls-server /&gt;
  &lt;/security&gt;
&lt;/lma-configuration&gt;</pre><p>The following optional attributes can be specified for the
<span class="emphasis"><em>tls-server</em></span> element:</p><div class="informaltable"><table border="1"><colgroup><col></colgroup><thead><tr><th>Attributes</th></tr></thead><tbody><tr><td>
            <code class="code">jmx.remote.tls.need.client.authentication</code>

            <p>
              A string that is "true" or "false"
              according to whether the connector server requires client
              authentication. If true, a client that does not
              authenticate during
              the handshake sequence will be refused
            </p>
          </td></tr><tr><td>
            <code class="code">jmx.remote.tls.want.client.authentication</code>

            <p>
              A string that is "true" or "false"
              according to whether the connector server requires client
              authentication if appropriate to the cipher suite
              negotiated. If true,
              then if a client negotiates a cipher suite that supports
              authentication but that client does not authenticate
              itself, the connection will be refused
            </p>
          </td></tr><tr><td>
            <code class="code">jmx.remote.tls.enabled.protocols</code>

            <p>
              A string that is a space-separated list of
              TLS protocols to enable. If the value of this property is
              not specified, the TLS enabled protocols default to
              <code class="code">SSLSocket.getEnabledProtocols()</code>.
            </p>
          </td></tr><tr><td>
            <code class="code">jmx.remote.tls.enabled.cipher.suites</code>

            <p>
              A string that is a space-separated list of
              TLS cipher suites to enable. If the value of this property
              is not specified the TLS enabled cipher suites default to
              <code class="code">SSLSocket.getEnabledCipherSuites()</code>.
            </p>
          </td></tr></tbody></table></div><p>
    The current implementation uses the JDK's default SSL socket
    factory to obtain SSL sockets. Should you wish to customize the
    key store, trust store, store type and passwords used by this SSL
    factory, you can do so by specifying system properties, as
    described in
    <a href="http://download.oracle.com/javase/1.5.0/docs/guide/security/jsse/JSSERefGuide.html#CustomizingStores" target="_top">Sun's JSSE reference guide</a>.
  </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="Local_Management_Agent_Configuration-Guest_Streaming"></a>3.2.4.&nbsp;Guest Application Log Streaming</h3></div></div></div><p>It is possible to configure the LMA to stream logs from a
  guest (non-CameronTec) application to the Management Information
  Server, where they can be displayed by the Dashboard. The logs
  from guest applications can be searched and filtered in the
  Dashboard in the same way as internal logs. They can also be used
  as the source of the Log-type interest events in the Dashboard,
  such as raising an event when there is an error in the log, or
  when a particular regular expression search matches a guest
  log.</p><p>Before guest logs are streamed to the Management Information Server,
    they are firstly rewritten in Catalys High Performance Log format,
    so that they can thereafter be treated identically to Catalys native
    logs.</p><p>This configuration is specified using the "guest" element of
  the LMA configuration, which has the following attributes.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Attribute</th><th>Description</th></tr></thead><tbody><tr><td>type</td><td>
          The type of guest application that this instance belongs
          to. Applications of the same type are grouped together in
          the Dashboard. Internally the LMA supports CatalysNode
          and UniversalServer types. Guest applications of the same
          type are also grouped. For example, all QuickFIX guest
          applications.

          <p>Required.</p>
        </td></tr><tr><td>name</td><td>
          The name of the guest application. This name appears
          (with any other guest applications of the same type) on
          the Dashboard. It can be filtered on or off in the
          Dashboard log display.

          <p>Required.</p>
        </td></tr><tr><td>logger.name</td><td>
          The name of the logger. This name appears beneath the
          guest application's name in the Dashboard. It can be
          filtered on or off in the Dashboard log display.

          <p>Required.</p>
        </td></tr><tr><td>file.scanner</td><td>
          The fully qualified file scanner class.

          <p>The class: <code class="code">com.camerontec.util.guestlogs.&shy;filenamingscheme.FixedFileScanner</code>
          is provided for log files with a fixed absolute name.</p>

          <p>The class: <code class="code">com.camerontec.util.guestlogs.&shy;filenamingscheme.DailyDatedFileScanner</code>
          is provided for log files which are named according to their date.</p>

          <p>
            Custom file scanners must implement the
            <a class="javadoc" href="../javadoc/com/camerontec/util/guestlogs/filenamingscheme/IFileScanner.html" target="_top">IFileScanner</a>
            interface, and must be included in the class path of the LMA.
          </p>

          <p>Required.</p>
        </td></tr><tr><td>file.pattern</td><td>
          The pattern that is used to identify log files associated
          with the guest application. This string must consist of a
          fixed absolute directory name; and a file name component
          that is either fixed (indicating there is only one log
          file), or contains a pattern that identifies multiple log
          files.

          <p>For the FixedFileScanner, this attribute is the
          absolute file name of the log file (e.g.
          "/log/files/directory/logfile.log").</p>

          <p>For the DailyDatedFileScanner, this attribute is the
          absolute directory plus a file name with a %d date token
          (e.g. "/log/files/directory/logfile%d.log).</p>

          <p>For custom file scanners, this pattern can contain
          other tokens that are interpreted by the file scanner
          (e.g. "/log/files/directory/logfile%d-%s.log where the %s
          token might represent a particular session
          identifier).</p>

          <p>Required.</p>
        </td></tr><tr><td>line.parser</td><td>
          The fully qualified line parser class.

          <p>The class: <code class="code">com.camerontec.util.guestlogs.lineparser.&shy;Log4jDefaultLineParser</code>
          is provided for log files that are in the Log4j
          default format:</p>
<pre class="programlisting"><span class="emphasis"><em>Timestamp</em></span> [<span class="emphasis"><em>Thread</em></span>] <span class="emphasis"><em>Level</em></span>  <span class="emphasis"><em>Owner</em></span> - <span class="emphasis"><em>Message</em></span></pre>
          <p>For example:</p>
          <pre class="programlisting">2013-06-10 14:19:40,911 [Main] INFO \
  CameronTec.Session.BUY_SELL.out - &gt; 8=...</pre>

          <p>The class: <code class="code">com.camerontec.util.guestlogs.lineparser.&shy;QuickFIXDefaultLineParser</code>
          is provided for log files that are in the QuickFIX
          default format:</p>
<pre class="programlisting"><span class="emphasis"><em>Date</em></span>, <span class="emphasis"><em>FIX version</em></span>:<span class="emphasis"><em>Session</em></span>, <span class="emphasis"><em>direction</em></span> (<span class="emphasis"><em>Message Contents</em></span>)</pre>
          <p>For example:</p>
          <pre class="programlisting">20120731-00:10:12, FIX.4.2:BUY-&gt;SELL, incoming (8=...)</pre>

          <p>
            Custom classes must implement the
            <a class="javadoc" href="../javadoc/com/camerontec/util/guestlogs/lineparser/ILineParser.html" target="_top">ILineParser</a>
            interface, and must be included in the class path of the LMA.
          </p>

          <p>Required.</p>
        </td></tr><tr><td>rewritten.log.max.file.length</td><td>The maximum size (in bytes) that a re-written guest log file can reach before roll over occurs.
              <p>Optional. Defaults to 2147483648 bytes (2GB).</p></td></tr><tr><td>rewritten.log.prune.period</td><td>The period over which to check and prune the high performance logs so that they
                match their guest log counterparts.
                <p>Optional. Defaults to 60000(ms).</p>
            </td></tr></tbody></table></div><p>There can be multiple guest elements contained in the LMA
  configuration. The combination of the "name" and "logger.name"
  attributes must be unique.</p><p>For example:</p><pre class="programlisting">&lt;guest
  type="QuickFIX"
  name="FIXEngine1"
  logger.name="SessionA_MessageLog"
  file.scanner="com.camerontec.util.guestlogs.filenamingscheme.FixedFileScanner"
  file.pattern="/apps/quickfix/logs/sessionA.log"
  line.parser="com.camerontec.util.guestlogs.lineparser.QuickFIXDefaultLineParser"
  /&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="Local_Management_Agent_Configuration-logsReplication"></a>3.2.5.&nbsp;Logs Replication</h3></div></div></div><p>Logs are replicated from the host that is generating the logs to the logs repository on a
    Management Information Server. The default properties of this replication
    process can be modified using the <code class="code">logs-replication-server</code> element.</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE lma-configuration
   SYSTEM 'http://www.camerontecgroup.com/dtd/management/lma-configuration.dtd'&gt;
&lt;lma-configuration&gt;
    &lt;logs-replication-server [logs replication properties]&gt;
&lt;/lma-configuration&gt;</pre><p>where the properties of this element can include:</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Attribute</th><th>Description</th></tr></thead><tbody><tr><td>socket.send.buffer.size</td><td>The size of the socket buffer that the LMA uses
             when sending log files to the MIS.
              <p>Defaults to 0 (the platform default).</p>
            </td></tr><tr><td>file.read.block.size</td><td>The amount of data (in bytes) that the LMA reads each time
              it accesses the log files on disk.
              <p>Defaults to 1MB or 1048576 bytes.</p>
            </td></tr><tr><td>thread.pool.size</td><td>The number of client requests that the LMA can process at one time.
              <p>Defaults to 4.</p>
            </td></tr><tr><td>use.compression</td><td>Whether data is compressed before sending it to the MIS.
              <p>Defaults to true.</p>
            </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="Local_Management_Agent_Configuration-Changing_the_default_jmx_request_timeout"></a>3.2.6.&nbsp;Changing default JMX request timeout</h3></div></div></div><p>
      By default, the timeout for communication between the LMA and managed FIX servers is set to 2000ms. To change the
      default timeout, a <code class="code">jmx-request-timeout</code>
      attribute of the <code class="code">lma-configuration</code> element must be specified. The format is as follows:
    </p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE lma-configuration
  SYSTEM 'http://www.camerontecgroup.com/dtd/management/lma-configuration.dtd'&gt;
  &lt;lma-configuration jmx-request-timeout="10000"/&gt;</pre></div></div><div xmlns:d="http://docbook.org/ns/docbook" class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch03.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch03.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch03s03.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;3.&nbsp;Configuration&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;3.3.&nbsp;Logging</td></tr></table></div><div xmlns:d="http://docbook.org/ns/docbook" xmlns:date="http://exslt.org/dates-and-times" id="footer_copyright"><div id="footer_copyright_pubdate">Published 2022-04-05T14:53:00+02:00</div><div id="footer_copyright_copy">
        Copyright &copy; 2022 CameronTec</div></div></body></html>